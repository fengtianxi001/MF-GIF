import{h as R,r as C,i as w,k as D,j as f,d as E,l as k,a as I,c as _,w as M,bX as h,m as y,p as B,f as c,u as i,q as b}from"./index.703b1ac4.js";import{u as V,l as n,c as T,g as $,B as A,b as L,e as j,_ as P,k as S,i as z,j as U}from"./BaseTableFilter.267a84e5.js";/* empty css                                              */import{v as Y}from"./index.1bb83285.js";function q(){const d=R([]),s=C([]),l=C({}),r=C([]),p=w(()=>[{label:"\u5F55\u50CF\u540D\u79F0",name:"name",component:"Input"},{label:"\u5F55\u50CF\u65F6\u957F",name:"size",component:"Select",props:{options:[]}}]),v=async()=>{const u=await navigator.mediaDevices.getDisplayMedia({video:!0,audio:!1}),o=[],t=new MediaRecorder(u,{mimeType:"video/webm"});t.ondataavailable=e=>{o.push(e.data)},t.start(100),t.onstop=async()=>{const e=new Blob(o);d.push({id:V(),url:URL.createObjectURL(e),name:"\u5F55\u50CF"+new Date().getTime(),size:e.size,type:e.type,lastModified:D().format("YYYY-MM-DD HH:mm:ss")}),F(),f.success("\u5F55\u50CF\u5BFC\u5165\u6210\u529F")}},m=async u=>{const o=n.exports.size(u);if(!await T({content:`\u5171 ${o} \u6761\u6570\u636E\uFF0C\u662F\u5426\u79FB\u9664\uFF1F`,okText:"\u786E\u8BA4\u79FB\u9664",cancelText:"\u53D6\u6D88\u64CD\u4F5C"}))return;const e=n.exports.remove(d,({id:a})=>u.includes(a));F(),f.success(`\u6210\u529F\u79FB\u9664 ${n.exports.size(e)} \u5F20\u56FE\u7247`)},F=()=>{const{name:u,size:o,type:t}=l.value;let e=[...d];u&&(e=e.filter(a=>a.name.toLowerCase().includes(u.toLowerCase()))),t&&(e=e.filter(a=>a.type.includes(t))),r.value=e,s.value=[]};return{videos:d,videoSelected:s,videoFilterParams:l,videoFilterResult:r,videoFilterConfigs:p,onCamera:v,onRemoveVideos:m,onFilter:F,onResetFilterResult:u=>{r.value=u},onConvertImage:async u=>{await $("video",u)}}}const N=E({__name:"index",setup(d){const{videoSelected:s,videoFilterParams:l,videoFilterResult:r,videoFilterConfigs:p,onCamera:v,onRemoveVideos:m,onFilter:F,onResetFilterResult:g,onConvertImage:x}=q(),u=[{title:"\u5F55\u50CF\u540D\u79F0",dataIndex:"name"},{title:"\u5F55\u50CF\u5927\u5C0F",render:({record:t})=>S(t.size)},{title:"\u6700\u540E\u7F16\u8F91\u65F6\u95F4",dataIndex:"lastModified"},{title:"\u64CD\u4F5C",width:100,render:({record:t})=>c(U,{},[c(z,{text:"\u64AD\u653E",icon:B,size:"small",onClick:()=>{Y(t.url)}}),c(z,{text:"\u79FB\u9664",color:"danger",icon:y,size:"small",onClick:()=>m([t.id])})])}],o=k(()=>[[{text:"\u5F00\u59CB\u5F55\u5C4F",icon:h,click:v},{text:"\u6279\u91CF\u79FB\u9664",icon:y,click:()=>{m(s.value)},props:{color:"danger",disabled:n.exports.size(s.value)===0}}],[{text:`\u8F6C\u5316\u9009\u62E9\u9879( ${n.exports.size(s.value)} )`,icon:B,click:()=>{if(n.exports.size(s.value)>1)return f.error("\u4E00\u6B21\u53EA\u80FD\u9009\u62E9\u8F6C\u6362\u4E00\u4E2A\u89C6\u9891\u6587\u4EF6");const t=r.value.filter(e=>s.value.includes(e.id));x(t.map(e=>e.url))},props:{disabled:n.exports.size(s.value)<1}}]]);return(t,e)=>(I(),_(A,{title:"\u5C4F\u5E55\u8F6CGIF"},{default:M(()=>[c(L,{modelValue:i(l),"onUpdate:modelValue":e[0]||(e[0]=a=>b(l)?l.value=a:null),configs:i(p),query:i(F)},null,8,["modelValue","configs","query"]),c(j,{list:i(o)},null,8,["list"]),c(P,{selectedKeys:i(s),"onUpdate:selectedKeys":e[1]||(e[1]=a=>b(s)?s.value=a:null),columns:u,data:i(r),draggable:{type:"handle",width:40},onChange:i(g)},null,8,["selectedKeys","data","onChange"])]),_:1}))}});export{N as default};
