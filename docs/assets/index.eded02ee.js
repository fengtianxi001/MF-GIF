import{h as w,r as B,i as D,j as y,k as R,d as V,l as _,a as A,c as M,w as P,I as $,m as g,p as z,f as d,u as i,q as E}from"./index.32878e5a.js";import{l as a,f as h,c as L,g as S,u as j,B as q,b as T,e as U,_ as Y,k as K,i as k,j as O}from"./BaseTableFilter.6641d827.js";import"./index.vue_vue_type_style_index_0_lang.382aa29c.js";import{v as G}from"./index.64cf193a.js";function H(){const l=w([]),o=B([]),r=B({}),c=B([]),F=D(()=>[{label:"\u89C6\u9891\u540D\u79F0",name:"name",component:"Input"},{label:"\u89C6\u9891\u5927\u5C0F",name:"size",component:"Select",props:{options:[]}},{label:"\u89C6\u9891\u7C7B\u578B",name:"type",component:"Select",props:{options:a.exports.uniq(a.exports.map(l,({type:e})=>e.replace("video/","")))}}]),C=async()=>{const e=await h("video/*"),u=a.exports.map(e,x),t=await Promise.all(u);l.push(...t),y.success(`\u6210\u529F\u5BFC\u5165 ${a.exports.size(t)} \u4E2A\u89C6\u9891`),p()},m=async e=>{const u=a.exports.size(e);if(!await L({content:`\u5171 ${u} \u6761\u6570\u636E\uFF0C\u662F\u5426\u79FB\u9664\uFF1F`,okText:"\u786E\u8BA4\u79FB\u9664",cancelText:"\u53D6\u6D88\u64CD\u4F5C"}))return;const s=a.exports.remove(l,({id:n})=>e.includes(n));p(),y.success(`\u6210\u529F\u79FB\u9664 ${a.exports.size(s)} \u5F20\u56FE\u7247`)},p=()=>{const{name:e,size:u,type:t}=r.value;let s=[...l];e&&(s=s.filter(n=>n.name.toLowerCase().includes(e.toLowerCase()))),t&&(s=s.filter(n=>n.type.includes(t))),c.value=s,o.value=[]},v=e=>{c.value=e},f=async e=>{await S("video",e)},x=async e=>{const u=j(),t=e.name,s=URL.createObjectURL(e),n=e.size,I=e.type,b=R(e.lastModified).format("YYYY-MM-DD HH:mm:ss");return{id:u,url:s,name:t,size:n,type:I,file:e,lastModified:b}};return{videos:l,videoSelected:o,videoFilterParams:r,videoFilterResult:c,videoFilterConfigs:F,onAddVideo:C,onRemoveVideos:m,onFilter:p,onResetFilterResult:v,onConvertImage:f}}const X=V({__name:"index",setup(l){const{videoSelected:o,videoFilterParams:r,videoFilterResult:c,videoFilterConfigs:F,onAddVideo:C,onRemoveVideos:m,onFilter:p,onResetFilterResult:v,onConvertImage:f}=H(),x=[{title:"\u89C6\u9891\u540D\u79F0",dataIndex:"name"},{title:"\u89C6\u9891\u5927\u5C0F",render:({record:u})=>K(u.size)},{title:"\u89C6\u9891\u7C7B\u578B",dataIndex:"type",render:({record:u})=>u.type.replace("video/","")},{title:"\u6700\u540E\u7F16\u8F91\u65F6\u95F4",dataIndex:"lastModified"},{title:"\u64CD\u4F5C",width:100,render:({record:u})=>d(O,{},[d(k,{text:"\u64AD\u653E",icon:z,size:"small",onClick:()=>{G(u.url)}}),d(k,{text:"\u79FB\u9664",color:"danger",icon:g,size:"small",onClick:()=>m([u.id])})])}],e=_(()=>[[{text:"\u6279\u91CF\u5BFC\u5165\u89C6\u9891",icon:$,click:C},{text:"\u6279\u91CF\u79FB\u9664",icon:g,click:()=>{m(o.value)},props:{color:"danger",disabled:a.exports.size(o.value)===0}}],[{text:`\u8F6C\u5316\u9009\u62E9\u9879( ${a.exports.size(o.value)} )`,icon:z,click:()=>{if(a.exports.size(o.value)>1)return y.error("\u4E00\u6B21\u53EA\u80FD\u9009\u62E9\u8F6C\u6362\u4E00\u4E2A\u89C6\u9891\u6587\u4EF6");const u=c.value.filter(t=>o.value.includes(t.id));f(u.map(t=>t.url))},props:{disabled:a.exports.size(o.value)<1}}]]);return(u,t)=>(A(),M(q,{title:"\u89C6\u9891\u8F6CGIF"},{default:P(()=>[d(T,{modelValue:i(r),"onUpdate:modelValue":t[0]||(t[0]=s=>E(r)?r.value=s:null),configs:i(F),query:i(p)},null,8,["modelValue","configs","query"]),d(U,{list:i(e)},null,8,["list"]),d(Y,{selectedKeys:i(o),"onUpdate:selectedKeys":t[1]||(t[1]=s=>E(o)?o.value=s:null),columns:x,data:i(c),draggable:{type:"handle",width:40},onChange:i(v)},null,8,["selectedKeys","data","onChange"])]),_:1}))}});export{X as default};
